---
title: "Tissue_ASHCsizestudy"
author: "Kelly Roper"
date: "2024-01-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("dplyr")                                    
library("plyr")                                     
library("readr")             
library("Rmisc")
library("ggplot2")
library("lubridate")

#Set Path
#setwd("C:/Users/kyra.lenderman/Documents/Github/KL_EAD-ASEB_EPA_LISS_Disease_Surveillance/Size_studyASHC/raw_data")

data_all <- read.csv("C:/Users/kelly.roper/Documents/Github/Roper_EAD-ASEB_EPA_LISS_Disease_Surveillance/Size_studyASHC/raw_data/SizeASHC_TissueProcessing.csv")
as.data.frame(data_all)

head(data_all)

```

#Removing unnecessary columns from data (such as light_regime and oyster_zone)
g <- select(data_all, -light_regime, -oyster_zone, -X:-X.12)
g

#Removing NA rows
data <- g %>%  filter(!row_number() %in% c(61:998))

ggplot(data, aes(ww_total_g, height_mm)) + 
  geom_point()
  
  

ggplot(data, aes(ww_total_g, height_mm, color = lab_sample)) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE) +
  theme(legend.position = "none")


ggplot(data, aes(ww_total_g, height_mm)) + 
  geom_point(aes(colour = condition)) + 
  geom_smooth(method = "lm", se = FALSE) 
  

 dplot <- ggplot(diamonds, aes(color, fill = cut)) + 
  xlab(NULL) + ylab(NULL) + theme(legend.position = "none")
  dplot+geom_bar()

data + geom_bar(position = "identity", alpha = 1 / 2, colour = "grey50")

print(data + ggtitle("The Height and Weight of Oysters from Ash Creek"))

print(data + labs(y = "Height(mm)", x = "Weight (g)"))


```{r}
sessionInfo()
```

library(tidyverse)

g+
xlab("Weight (g)")+
ylab("Height (mm)")

head(data)
tail(data)

class(data$ww_total_g)
class(data$height_mm)

class(data$data)

df$net <- df$data- as.numeric(df$data)

data <- ggplot(data, aes(ww_total_g, height_mm))+ geom_point()
data


ggplot(data, aes(x = ww_total_g, y = height_mm ))

ggplot(data, aes(x = ww_total_g, y = height_mm ))+ geom_point(color = "red")

ggplot(data, aes(x = ww_total_g, y = height_mm ))+ geom_point(color = "red") + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek")


ggplot(data, aes(x = ww_total_g, y = height_mm ))+ geom_point(color = "red") + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek") +geom_smooth()

ggplot(data, aes(x = ww_total_g, y = height_mm ))+ geom_point(color = "red") + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek") +geom_smooth(method = "lm", se = FALSE)


ggplot(data, aes(x = ww_total_g, y = height_mm, color = condition ))+ geom_point() + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek") +geom_smooth(method = "lm", se = FALSE)


ggplot(data, aes(x = ww_total_g, y = height_mm, color = condition ))+ geom_point() + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek") +geom_smooth(method = "lm", se = FALSE)+ facet_wrap(~condition)


 data.labs <- c("2 Good", "3 Good Minus","4 Fair Plus", "5 Fair", "7 Poor Plus", "9 Very Poor")
 names(data.labs)<-  c("2_good", "3_good_minus", "4_fair_plus", "5_fair", "7_poor_plus", "9_very_poor")

data+facet_grid()

ggplot(data, aes(x = ww_total_g))+ geom_histogram(color = "blue", fill = condition) + labs(x = "Weight (g)", title = "Weight vs Height Ash Creek")

ggplot(data, aes(x = ww_total_g, y = height_mm, color = condition ))+ geom_bin_2d() + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek") +geom_smooth(method = "lm", se = FALSE)+ facet_wrap(~condition)

ggplot(data, aes(x = ww_total_g, y = height_mm, color = condition ))+ geom_violin() + labs(x = "Weight (g)", y = "Height (mm)", title = "Weight vs Height Ash Creek") +geom_smooth(method = "lm", se = FALSE)+ facet_wrap(~condition)


g + geom_line(aes(g = g)) + geom_errorbar(aes(ymin = lower, ymax = upper)), width = 0.2)


ggplot(data, aes(x = condition)) +
  geom_bar()


ggplot(
  data = data,
  mapping = aes(x = ww_total_g, y = height_mm)
) +
  geom_point(aes(color = condition, shape = condition)) +
  geom_smooth(method = "lm") +
  labs(
    title = "Total weight and height",
    subtitle = "Dimensions for Eastern Oysters at Ash Creek",
    x = "Total Weight (g)", y = "Height (mm)",
    color = "Condition", shape = "Condition"
  )
  
  
  data + scale_fill_discrete(name"Condition", 
  breaks = c("2_good","3_good_minus","4_fair_plus","5_fair","7_poor_plus","9_very_poor"),
  labels=c("Good", "Good Minus", "Fair Plus", "Fair", "Poor Plus", "Very Poor"))
  
  