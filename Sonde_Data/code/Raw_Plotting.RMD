---
title: "Sonde_raw_plots"
author: "Samuel Gurr"
date: "2023-10-03"
output: html_document
---

Last updated 5/6/24 by M. Kachmar
   - all data currently up to date and merged to master file
   - when making graphs will want to seperate by year moving forward - code needs to be updated


## Setup: 

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE, 
                      message = FALSE, 
                      cache = TRUE)

#knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
#knitr::opts_knit$set(root.dir = "C:/Users/kyra.lenderman/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")

knitr::opts_knit$set(root.dir = "C:/Users/mariah.kachmar/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")

```

#### Load libraries

```{r load_libraries, include = TRUE}
# load libraries - notes show the install command needed to install (pre installed)
# Plotting
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
```

#### Set path

```{r set the path out, include = TRUE}
path_out = 'C:/Users/samjg/Documents/Github_repositories/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data/output'
```

#### Set path for Mariah K. 
```{r set the path out, include = TRUE}
path_out <-'C:/Users/mariah.kachmar/Documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data/output'
```


```{r}
path.p                   <- "C:/Users/mariah.kachmar/Documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data/raw_data" 
file.names.2023         <- data.frame(txt.files = 
                                         (basename(list.files(path = paste(path.p,'/',sep=''), 
                                                              pattern = "csv$", 
                                                              recursive = FALSE)))) 
   
Master_2023             <- data.frame() 


# Notes on formatting datas 
# ymd_hms for 072023_GOLD_Sonde.csv, 072023_LAUR_Sonde.csv, 082023_FENC_Sonde.csv, 082023_GOLD_Sonde.csv, 092023_FENC_Sonde.csv
# mdy_hms for 072023_ASHC_Sonde.csv
# mdy_hm for 082023_ASHC_Sonde.csv, 082023_LAUR_Sonde.csv, 092023_ASHC_Sonde.csv, 092023_GOLD_Sonde.csv, 102023_ASHC_Sonde.csv,102023_FENC_Sonde.csv, 102023_GOLD_Sonde.csv, 102023_LAUR_Sonde.csv, 112023_ASHC_Sonde.csv, 112023_FENC_Sonde.csv

# for loop to merge all csv files to one dataframe

for (m in 1:nrow(file.names.2023)) {
  # call the dir of the csv file in loop
  raw_Sonde_rootdir        <- paste(path.p,'/',file.names.2023[m,1], sep='') #reads in the data files
  
  # read it and fix dates and whatnot yay
  D        <- readLines(raw_Sonde_rootdir) 
  ind      <- grep('Date Time',D) # the line where the data stars (theres a lot of junk beforehand)
  # raw      <- read.csv(paste(path.p,'/',file.names.table[m,1], sep=''),skip=ind-1)
  raw      <- read_csv(raw_Sonde_rootdir,skip=ind-1,col_types = cols())
  columns  <- names(raw) # what are the column names?  - youll see why
  raw_df   <- as.data.frame(raw) # ocnvert the dataframe now that you skipped the crappola 
  raw_df[2:(ncol(raw_df))] <- lapply(raw_df[2:(ncol(raw_df))],as.numeric) # convert all data  to numeric
  # ommit all numeric data, also the format of the units does not pair between datasets, cannot rbind later
  names(raw_df) <- sapply(strsplit(names(raw_df), '\\s*[()]'), `[`, 1) 
  raw_df[,1]

  # now for the dates - for some reason the sondes have diff format -  fix it up!
  if(gsub(".*/","", (gsub("\\","/",raw_Sonde_rootdir, fixed=T))) %in%
     c('082023_ASHC_Sonde.csv',
       '082023_LAUR_Sonde.csv',

       '092023_ASHC_Sonde.csv',
       '092023_GOLD_Sonde.csv',

       '102023_ASHC_Sonde.csv',
       '102023_FENC_Sonde.csv',
       '102023_GOLD_Sonde.csv',
       '102023_LAUR_Sonde.csv',

       '112023_ASHC_Sonde.csv',
       '112023_FENC_Sonde.csv'))  { # date formatted as mdy_hm
    raw_df[,1] <- mdy_hm(raw_df[,1]) # reformat as date using lubridate
    } else if (gsub(".*/","", (gsub("\\","/",raw_Sonde_rootdir, fixed=T))) %in%
               '072023_ASHC_Sonde.csv') {
      raw_df[,1] <- mdy_hms(raw_df[,1]) # reformat as date using lubridate
    } else (raw_df[,1] <- ymd_hms(raw_df[,1]) # reformat as date using lubridate
  )

  # add a column for the site 
  filename      <- file.names.table[m,1]
  raw_df        <- raw_df %>% 
                    dplyr::mutate(Site = sub(".*_(.*)_.*","\\1",filename),
                    Date = gsub("_.*","",filename)) 
  
  Master_2023 <- rbind(raw_df,Master_2023) #bind to a cumulative list dataframe
}

write.csv(Master_2023, "output/Sonde_2023_Master.csv",)

########################## 2024 data only##################################
# Individually pulling in data to troubleshoot date issue - dates are coming in as characters which is why they are not merging above. Pull in yearly data seperately?



file.names.2024<- data.frame(txt.files = (basename(list.files(path = "raw_data/2024", 
                                                              pattern = "csv$", 
                                                              recursive = FALSE))))

Master_2024 <- data.frame()

for (m in 1:nrow(file.names.2024)) {
  # call the dir of the csv file in loop
  raw_Sonde_rootdir2        <- paste(path= "raw_data/2024",'/',file.names.2024[m,1], sep='') #reads in the data files
  
  # read it and fix dates and whatnot yay
  D2        <- readLines(raw_Sonde_rootdir2) 
  ind2      <- grep('Date Time',D2) # the line where the data stars (theres a lot of junk beforehand)
  # raw      <- read.csv(paste(path.p,'/',file.names.table[m,1], sep=''),skip=ind-1)
  raw2      <- read_csv(raw_Sonde_rootdir2,skip=ind2-1,col_types = cols())
  columns  <- names(raw2) # what are the column names?  - youll see why
  raw_df_2024   <- as.data.frame(raw2) # ocnvert the dataframe now that you skipped the crappola 
  raw_df_2024[2:(ncol(raw_df_2024))] <- lapply(raw_df_2024[2:(ncol(raw_df_2024))],as.numeric) # convert all data  to numeric
  # ommit all numeric data, also the format of the units does not pair between datasets, cannot rbind later
  raw_df_2024$`Date Time` <- mdy_hm(raw_df_2024$`Date Time`)
  names(raw_df_2024) <- sapply(strsplit(names(raw_df_2024), '\\s*[()]'), `[`, 1) 
  raw_df_2024[,1]


# Add site information
filename2 <- file.names.2024[m, 1]
raw_df_2024 <- raw_df_2024 %>%
  dplyr::mutate(Site = sub(".*_(.*)_.*", "\\1", filename2),
                Date = gsub("_.*", "", filename2))

# Combine with Master_Table2
Master_2024 <- rbind(raw_df_2024, Master_2024)

#Master_Table2[,1] <- mdy_hms(Master_Table2[,1])

} 


class( raw_df_2024$`Date Time`)


######### Merging 2023 and 2024 for a master sheet
Master_Table <- rbind(Master_2023, Master_2024)



View(Master_Table)
```

# Visualize data 


### Raw visual (ready. set. blobs!)

* lets look at an example of raw data 

```{r}
# melt is akin to pivot_longer, but I like that its called melt so I prefer it
# Im melting Im melting
library(reshape2)
Master_Table_LONG <- Master_Table %>%  
                      dplyr::select(-c("External Voltage", "Battery Capacity", "Barometric Pressure", "Date")) %>% 
                      melt(id.vars = c("Date Time", "Site"),
                                    measure.vars = c("Actual Conductivity", "Salinity", "Resistivity", 
                                                     "Total Dissolved Solids" ,"RDO Concentration", "RDO Saturation",
                                                     "Oxygen Partial Pressure", "Chlorophyll-a Fluorescence", "pH", "pH mV", 
                                                     "Temperature"))

write.csv(Master_Table_LONG, "output/Sonde_master.csv", )

# View the blobs! 
ggplot(Master_Table_LONG,
         aes(x=`Date Time`,
             y=value,
             fill=Site)) +
  geom_point() +
  theme_classic() + 
  facet_wrap(~variable, scales = "free_y")

```

* As suspected this visual is horrible.. we have TONS of data, every 10 seconds to be exact! 

* if we want to view trends, we need to narrow down 

### Hourly means


```{r}
Master_Table_LONG_means <- Master_Table %>%  
                      dplyr::select(-c("External Voltage", "Battery Capacity", "Barometric Pressure", "Date")) %>% 
                      dplyr::mutate(`Date Time` = as.factor(substr(`Date Time`,1,13))) %>% # remove minutes and seconds
                      melt(id.vars = c("Date Time", "Site"),
                                    measure.vars = c("Actual Conductivity", "Salinity", "Resistivity", 
                                                     "Total Dissolved Solids" ,"RDO Concentration", "RDO Saturation",
                                                     "Oxygen Partial Pressure", "Chlorophyll-a Fluorescence", "pH", "pH mV", 
                                                     "Temperature")) %>% 
                      dplyr::group_by(`Date Time`, Site, variable) %>% 
                      summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), value) %>% 
                      dplyr::mutate(`Date Time` = ymd_h(`Date Time`)) # reformat back to date 

vars <- as.data.frame(
          list(
            as.character(
              unique(
                Master_Table_LONG_means$variable)))) %>% 
        dplyr::rename(dat = 1)

write.csv(Master_Table_LONG_means, "output/Sonde_hourly_means_master.csv",)

CT_means<- Master_Table_LONG_means[Master_Table_LONG_means$Site == "ASHC" | Master_Table_LONG_means$Site =="FENC", ]


write.csv(CT_means, "output/Sonde_hourly_means_CT.csv")

for(i in 1:nrow(vars)) {
  
  # filter table for each variable
  Table_by_var <- Master_Table_LONG_means %>% 
                    dplyr::filter(variable %in% vars[i,])
  
  # plot each
  plot <- Table_by_var %>% 
              ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#CC79A7", "#D55E00", "#009E73", "#0072B2")) + 
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site), scales = "free_y") +
              ggtitle(vars[i,]) +
              theme_bw()
  
  # print plots and name them as the var    
  pdf(paste0(path_out,"/raw_plots/",gsub(" ", "_", vars[i,]),".pdf"), height = 12, width = 15)
  print(plot) 
  dev.off()

  } # close the loop


# Temperature pre October 1st 2023 
# why? we have a hefty gap in the FENC data during all october, this is 
# a clean plot for Genevieve's NACE 2024 presentation
Sonde_Temp_2023 <- Table_by_var %>% 
    dplyr::filter(variable %in% vars[11,]) %>% 
    dplyr::filter(`Date Time` > '2023-06-15 00:00:00' & `Date Time` < '2024-05-01 00:00:00') %>% 
              ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#CC79A7", "#D55E00", "#009E73", "#0072B2")) + 
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site), scales = "free_y") +
              ggtitle(vars[11,]) +
              theme_bw()
 
pdf(paste0(path_out,"/raw_plots/Temperature_JuneOct_2023.pdf"), height = 12, width = 15)
print(Sonde_Temp_2023) 
dev.off()
  
```

# Clean CT sites (ASHC and FENC) for the LISS proposal
```{r, figs for LISS proposal}

CT_pH          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC', 'ASHC'))
CT_Salinity    <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC', 'ASHC'))
CT_Temperature <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC'))
CT_DO          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC', 'ASHC'))


# pH 

CT_pH_all <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-09-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Summer") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")


CT_pH_callout <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path_out,"/raw_plots/LISS_proposal_plots/CT_pH.pdf"), height = 6, width = 11)
ggarrange(CT_pH_all, CT_pH_callout, ncol = 2, widths = c(2, 1))
dev.off()
  





# Salinity 

CT_Salinity_all <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-09-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Summer") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none")


CT_Salinity_callout <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path_out,"/raw_plots/LISS_proposal_plots/CT_Salinity.pdf"), height = 6, width = 11)
ggarrange(CT_Salinity_all, CT_Salinity_callout, ncol = 2, widths = c(2, 1))
dev.off()


# Temperature 

CT_Temperature_all <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-09-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Summer") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")


CT_Temperature_callout <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path_out,"/raw_plots/LISS_proposal_plots/CT_Temperature.pdf"), height = 6, width = 11)
ggarrange(CT_Temperature_all, CT_Temperature_callout, ncol = 2, widths = c(2, 1))
dev.off()


# DO 

CT_DO_all <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-09-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Summer") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")


CT_DO_callout <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path_out,"/raw_plots/LISS_proposal_plots/CT_DO.pdf"), height = 6, width = 11)
ggarrange(CT_DO_all, CT_DO_callout, ncol = 2, widths = c(2, 1))
dev.off()

```

# Clean ASHC for the LISS stakeholder reports
```{r, figs for LISS stakeholder reports}

ASHC_pH          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('ASHC'))
ASHC_Salinity    <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('ASHC'))
ASHC_Temperature <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('ASHC'))
ASHC_DO          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('ASHC'))
ASHC_CHLA        <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('ASHC'))

# pH 

ASHC_pH_all <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_pH_callout <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_pH_all
ASHC_pH_callout

pdf(paste0(path_out,"/raw_plots/Report_plots/ASHC_pH.pdf"), height = 7, width = 14)
print(ASHC_pH_all)
#ggarrange(ASHC_pH_all,ASHC_pH_callout, ncol = 2, widths = c(2, 1))
dev.off()
  



# Salinity 

ASHC_Salinity_all <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_Salinity_all

ASHC_Salinity_callout <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

ASHC_Salinity_callout

pdf(paste0(path_out,"/raw_plots/Report_plots/ASHC_Salinity.pdf"), height = 7, width = 14)
print(ASHC_Salinity_all)
#ggarrange(ASHC_Salinity_all,ASHC_Salinity_callout, ncol = 2, widths = c(2, 1))
dev.off()


# Temperature 

ASHC_Temperature_all <-ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
ASHC_Temperature_all

ASHC_Temperature_callout <- ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_Temperature_callout

pdf(paste0(path_out,"/raw_plots/Report_plots/ASHC_Temperature.pdf"), height = 7, width = 14)
print(ASHC_Temperature_all)
#ggarrange(ASHC_Temperature_all, ASHC_Temperature_callout, ncol = 2, widths = c(2, 1))
dev.off()


# DO 

ASHC_DO_all <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_DO_callout <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path_out,"/raw_plots/Report_plots/ASHC_DO.pdf"), height = 7, width = 14)
print(ASHC_DO_all)
#ggarrange(ASHC_DO_all, ASHC_DO_callout, ncol = 2, widths = c(2, 1))
dev.off()

#Chlorophyll-a

ASHC_CHLA_all <- ASHC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_CHLA_all

pdf(paste0(path_out,"/raw_plots/Report_plots/ASHC_CHLA.pdf"), height = 7, width = 14)
print(ASHC_CHLA_all)
```

```{r}

## DAILY AVERAGES OF DO - ASHC###

ASHC_DO$`Date Time` <- as.character(ASHC_DO$`Date Time`)
date_time <- strsplit(ASHC_DO$`Date Time`, " ")  # Split at the space
print(ASHC_DO)

# Create separate columns for date and time
ASHC_DO$date <- sapply(date_time, "[[", 1)  # Extract date
#ASHC_DO$time <- sapply(date_time, "[[", 2)
print(ASHC_DO)


ASHC_DO_avg <- ASHC_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
ASHC_DO_avg


class(ASHC_DO_avg$Date)
ASHC_DO_avg$date <- as.Date(ASHC_DO_avg$date)

ASHC_DAILY_DO <- ASHC_DO_avg %>% ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  scale_y_continuous(limits= c(2,10), breaks = seq(2,10, by= 1))



ASHC_DAILY_DO

pdf(paste0(path_out,"/raw_plots/Report_plots/ASHC_daily_DO.pdf"), height = 7, width = 14)
print(ASHC_DAILY_DO)

# Monthly mean temperatures ASHC
ASHC_Temperature$`Date Time` <- as.character(ASHC_Temperature$`Date Time`)
date_time <- strsplit(ASHC_Temperature$`Date Time`, " ")  # Split at the space
print(ASHC_Temperature)

# Create separate columns for date and time
ASHC_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
#ASHC_Temperature$time <- sapply(date_time, "[[", 2)
print(ASHC_Temperature)

ASHC_Temperature$Month <- month(ASHC_Temperature$date, label = TRUE)
head(ASHC_Temperature)

ASHC_Monthly_Temperature <- ASHC_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
ASHC_Monthly_Temperature

```
# Clean GOLD for the LISS stakeholder reports
```{r, figs for LISS stakeholder reports}

GOLD_pH          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('GOLD'))
GOLD_Salinity    <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('GOLD'))
GOLD_Temperature <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('GOLD'))
GOLD_DO          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('GOLD'))
GOLD_CHLA        <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('GOLD'))

# pH 

GOLD_pH_all <- GOLD_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


GOLD_pH_all


pdf(paste0(path_out,"/raw_plots/Report_plots/GOLD_pH.pdf"), height = 7, width = 14)
print(GOLD_pH_all)
dev.off()
  


# Salinity 

GOLD_Salinity_all <- GOLD_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

GOLD_Salinity_all

pdf(paste0(path_out,"/raw_plots/Report_plots/GOLD_Salinity.pdf"), height = 7, width = 14)
print(GOLD_Salinity_all)
dev.off()


# Temperature 

GOLD_Temperature_all <-GOLD_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
GOLD_Temperature_all


pdf(paste0(path_out,"/raw_plots/Report_plots/GOLD_Temperature.pdf"), height = 7, width = 14)
print(GOLD_Temperature_all)
dev.off()


# DO 

GOLD_DO_all <- GOLD_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path_out,"/raw_plots/Report_plots/GOLD_DO.pdf"), height = 7, width = 14)
print(GOLD_DO_all)
dev.off()

#Chlorophyll-a

GOLD_CHLA_all <- GOLD_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

GOLD_CHLA_all

pdf(paste0(path_out,"/raw_plots/Report_plots/GOLD_CHLA.pdf"), height = 7, width = 14)
print(GOLD_CHLA_all)
```

```{r}

## DAILY AVERAGES OF DO - GOLD###

GOLD_DO$`Date Time` <- as.character(GOLD_DO$`Date Time`)
date_time <- strsplit(GOLD_DO$`Date Time`, " ")  # Split at the space
print(GOLD_DO)

# Create separate columns for date and time
GOLD_DO$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_DO)


GOLD_DO_avg <- GOLD_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
GOLD_DO_avg


class(GOLD_DO_avg$Date)
GOLD_DO_avg$date <- as.Date(GOLD_DO_avg$date)

GOLD_DAILY_DO <- GOLD_DO_avg %>% ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")


GOLD_DAILY_DO

pdf(paste0(path_out,"/raw_plots/Report_plots/GOLD_daily_DO.pdf"), height = 7, width = 14)
print(GOLD_DAILY_DO)

# Monthly mean temperatures ASHC
GOLD_Temperature$`Date Time` <- as.character(GOLD_Temperature$`Date Time`)
date_time <- strsplit(GOLD_Temperature$`Date Time`, " ")  # Split at the space
print(GOLD_Temperature)

# Create separate columns for date and time
GOLD_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_Temperature)

GOLD_Temperature$Month <- month(GOLD_Temperature$date, label = TRUE)
head(GOLD_Temperature)

GOLD_Monthly_Temperature <- GOLD_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
GOLD_Monthly_Temperature

#Salinity average
GOLD_Salinity$`Date Time` <- as.character(GOLD_Salinity$`Date Time`)
date_time <- strsplit(GOLD_Salinity$`Date Time`, " ")  # Split at the space
print(GOLD_Salinity)

# Create separate columns for date and time
GOLD_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_Salinity)

GOLD_Salinity$Month <- month(GOLD_Salinity$date, label = TRUE)
head(GOLD_Salinity)

GOLD_Monthly_Salinity <- GOLD_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
GOLD_Monthly_Salinity

```


# Clean LAUR for the LISS stakeholder reports
```{r, figs for LISS stakeholder reports}

LAUR_pH          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('LAUR'))
LAUR_Salinity    <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('LAUR'))
LAUR_Temperature <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('LAUR'))
LAUR_DO          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('LAUR'))
LAUR_CHLA        <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('LAUR'))

# pH 
LAUR_pH

LAUR_pH_all <- LAUR_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-20 11:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


LAUR_pH_all


pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_pH.pdf"), height = 7, width = 14)
print(LAUR_pH_all)
dev.off()
  


# Salinity 
## There are a few outliers in the dataset form removing the sonde to download data. Here is a temporary filter for graphing purposes:
LAUR_Salinity <- LAUR_Salinity[LAUR_Salinity$mean < 35 & LAUR_Salinity$mean > 24, ]

LAUR_Salinity_all <- LAUR_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(limits = c(0,30),breaks = seq(0,30, by = 2))

LAUR_Salinity_all

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_Salinity.pdf"), height = 7, width = 14)
print(LAUR_Salinity_all)
dev.off()


# Temperature 

LAUR_Temperature_all <-LAUR_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
LAUR_Temperature_all


pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_Temperature.pdf"), height = 7, width = 14)
print(LAUR_Temperature_all)
dev.off()


# DO 

LAUR_DO_all <- LAUR_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_DO.pdf"), height = 7, width = 14)
print(LAUR_DO_all)
dev.off()

#Chlorophyll-a

LAUR_CHLA_all <- LAUR_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

LAUR_CHLA_all

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_CHLA.pdf"), height = 7, width = 14)
print(LAUR_CHLA_all)

```

```{r}

## DAILY AVERAGES OF DO - LAUR ###

LAUR_DO$`Date Time` <- as.character(LAUR_DO$`Date Time`)
date_time <- strsplit(LAUR_DO$`Date Time`, " ")  # Split at the space
print(LAUR_DO)

# Create separate columns for date and time
LAUR_DO$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_DO)


LAUR_DO_avg <- LAUR_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
LAUR_DO_avg


class(LAUR_DO_avg$Date)
LAUR_DO_avg$date <- as.Date(LAUR_DO_avg$date)

LAUR_DAILY_DO <- LAUR_DO_avg %>% ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


LAUR_DAILY_DO

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_daily_DO.pdf"), height = 7, width = 14)
print(LAUR_DAILY_DO)

# Monthly mean temperatures ASHC
LAUR_Temperature$`Date Time` <- as.character(LAUR_Temperature$`Date Time`)
date_time <- strsplit(LAUR_Temperature$`Date Time`, " ")  # Split at the space
print(LAUR_Temperature)

# Create separate columns for date and time
LAUR_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_Temperature)

LAUR_Temperature$Month <- month(LAUR_Temperature$date, label = TRUE)
head(LAUR_Temperature)

LAUR_Monthly_Temperature <- LAUR_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
LAUR_Monthly_Temperature

#Salinity average
LAUR_Salinity$`Date Time` <- as.character(LAUR_Salinity$`Date Time`)
date_time <- strsplit(LAUR_Salinity$`Date Time`, " ")  # Split at the space
print(LAUR_Salinity)

# Create separate columns for date and time
LAUR_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_Salinity)

LAUR_Salinity$Month <- month(LAUR_Salinity$date, label = TRUE)
head(LAUR_Salinity)

LAUR_Monthly_Salinity <- LAUR_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
LAUR_Monthly_Salinity

```
# Clean FENC for the LISS stakeholder reports
```{r, figs for LISS stakeholder reports}

FENC_pH          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC'))
FENC_Salinity    <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC'))
FENC_Temperature <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC'))
FENC_DO          <- Master_Table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC'))
FENC_CHLA        <- Master_Table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('FENC'))

# pH 

FENC_pH_all <- FENC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2024-05-01 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Ash Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


FENC_pH_all


pdf(paste0(path_out,"/raw_plots/Report_plots/FENC_pH.pdf"), height = 7, width = 14)
print(FENC_pH_all)
dev.off()
  


# Salinity 

FENC_Salinity_all <- FENC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2024-05-01 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

FENC_Salinity_all

pdf(paste0(path_out,"/raw_plots/Report_plots/FENC_Salinity.pdf"), height = 7, width = 14)
print(FENC_Salinity_all)
dev.off()


# Temperature 

FENC_Temperature_all <-FENC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2024-05-01 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
FENC_Temperature_all


pdf(paste0(path_out,"/raw_plots/Report_plots/FENC_Temperature.pdf"), height = 7, width = 14)
print(FENC_Temperature_all)
dev.off()


# DO 

FENC_DO_all <- FENC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2024-05-01 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path_out,"/raw_plots/Report_plots/FENC_DO.pdf"), height = 7, width = 14)
print(FENC_DO_all)
dev.off()

#Chlorophyll-a

FENC_CHLA_all <- FENC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2024-05-01 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

FENC_CHLA_all

pdf(paste0(path_out,"/raw_plots/Report_plots/FENC_CHLA.pdf"), height = 7, width = 14)
print(FENC_CHLA_all)

```

```{r}

## DAILY AVERAGES OF DO - FENC ###

FENC_DO$`Date Time` <- as.character(FENC_DO$`Date Time`)
date_time <- strsplit(FENC_DO$`Date Time`, " ")  # Split at the space
print(FENC_DO)

# Create separate columns for date and time
FENC_DO$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_DO)


FENC_DO_avg <- FENC_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
FENC_DO_avg


class(FENC_DO_avg$Date)
FENC_DO_avg$date <- as.Date(FENC_DO_avg$date)

FENC_DO_avg

FENC_DAILY_DO <- FENC_DO_avg %>% dplyr::filter(`date` > '2023-06-01 00:00:00' & `date` < '2023-10-15 00:00:00' ) %>% 
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


FENC_DAILY_DO

pdf(paste0(path_out,"/raw_plots/Report_plots/FENC_daily_DO.pdf"), height = 7, width = 14)
print(FENC_DAILY_DO)

# Monthly mean temperatures ASHC
FENC_Temperature$`Date Time` <- as.character(FENC_Temperature$`Date Time`)
date_time <- strsplit(FENC_Temperature$`Date Time`, " ")  # Split at the space
print(FENC_Temperature)

# Create separate columns for date and time
FENC_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_Temperature)

FENC_Temperature$Month <- month(FENC_Temperature$date, label = TRUE)
head(FENC_Temperature)

FENC_Monthly_Temperature <-FENC_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
FENC_Monthly_Temperature

#Salinity average
FENC_Salinity$`Date Time` <- as.character(FENC_Salinity$`Date Time`)
date_time <- strsplit(FENC_Salinity$`Date Time`, " ")  # Split at the space
print(FENC_Salinity)

# Create separate columns for date and time
FENC_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_Salinity)

FENC_Salinity$Month <- month(FENC_Salinity$date, label = TRUE)
head(FENC_Salinity)

FENC_Monthly_Salinity <- FENC_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
FENC_Monthly_Salinity

```
