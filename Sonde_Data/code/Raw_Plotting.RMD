---
title: "Sonde_raw_plots"
author: "Samuel Gurr"
date: "2023-10-03"
output: html_document
---

Last updated 9/18/2024 by M.Kachmar


## Setup: 

* call your root directory, using opts_knit assigns for the entire script so your paths will alwyas be from this start point!

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE, 
                      message = FALSE, 
                      cache = TRUE)

#knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
#knitr::opts_knit$set(root.dir = "C:/Users/kyra.lenderman/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
knitr::opts_knit$set(root.dir = "C:/Users/mariah.kachmar/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
#knitr::opts_knit$set(root.dir = "C:/Users/kelly.roper/documents/Github/EAD-ASEB_EPA_LISS_Disease_Surveillance/Sonde_Data")
```

```{r load_libraries, include = TRUE}
# load libraries - notes show the install command needed to install (pre installed)
# Plotting
library(ggplot2)
library(dplyr)
library(gplots)
library(RColorBrewer)
library(ggpubr)
library(stringr)
library(lubridate)
library(readr)
library(reshape2)
library(tidyverse) # read_csv call from readr, included in tidyverse
```



## Load data:

```{r load data}

Master_table <- read.csv("output/Sonde_master.csv",check.names=FALSE) %>% dplyr::select(-1) # check.names = F allows with col names with spaces (opthwise fills with a '.' )

Master_table$`Date Time` <- lubridate::ymd_hms(Master_table$`Date Time`)

```

```{r}
#pathout <- 'Sonde_Data/output'
```
# Visualize data 


### Raw visual (ready. set. blobs!)

* lets look at an example of raw data 

```{r}
# melt is akin to pivot_longer, but I like that its called melt so I prefer it
# Im melting Im melting
library(reshape2)
Master_table_LONG <- Master_table %>%  
                      melt(id.vars = c("Date Time", "Site"),
                                    measure.vars = c("Actual Conductivity", "Salinity", "Resistivity", 
                                                     "Total Dissolved Solids" ,"RDO Concentration", "RDO Saturation",
                                                     "Oxygen Partial Pressure", "Chlorophyll-a Fluorescence", "pH", "pH mV", 
                                                     "Temperature"))

# View the blobs! 
ggplot(Master_table_LONG,
         aes(x=`Date Time`,
             y=value,
             fill=Site)) +
  geom_point() +
  theme_classic() + 
  facet_wrap(~variable, scales = "free_y")

```

* As suspected this visual is horrible.. we have TONS of data, every 10 seconds to be exact! 

* if we want to view trends, we need to narrow down 

### Hourly means


```{r}
Master_table_LONG_means <- Master_table %>%  
                      dplyr::mutate(`Date Time` = as.factor(substr(`Date Time`,1,13))) %>% # remove minutes and seconds
                      melt(id.vars = c("Date Time", "Site"),
                                    measure.vars = c("Actual Conductivity", "Salinity", "Resistivity", 
                                                     "Total Dissolved Solids" ,"RDO Concentration", "RDO Saturation",
                                                     "Oxygen Partial Pressure", "Chlorophyll-a Fluorescence", "pH", "pH mV", 
                                                     "Temperature")) %>% 
                      dplyr::group_by(`Date Time`, Site, variable) %>% 
                      summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), value) %>% 
                      dplyr::mutate(`Date Time` = ymd_h(`Date Time`)) # reformat back to date 

vars <- as.data.frame(
          list(
            as.character(
              unique(
                Master_table_LONG_means$variable)))) %>% 
        dplyr::rename(dat = 1)

write.csv(Master_table_LONG_means, "output/Sonde_hourly_means_master.csv",)

#### CT SITES ONLY ####

CT_means<- Master_table_LONG_means[Master_table_LONG_means$Site == "ASHC" | Master_table_LONG_means$Site =="FENC", ]



write.csv(CT_means, "output/Sonde_hourly_means_CT.csv")

for(i in 1:nrow(vars)) {
  
  # filter table for each variable
  Table_by_var <- Master_table_LONG_means %>% 
                    dplyr::filter(variable %in% vars[i,])
  
  # plot each
  plot <- Table_by_var %>% 
              ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#CC79A7", "#D55E00", "#009E73", "#0072B2")) + 
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site), scales = "free_y") +
              ggtitle(vars[i,]) +
              theme_bw()
  
  # print plots and name them as the var    
  pdf(paste0(path= "/raw_plots",gsub(" ", "_", vars[i,]),".pdf"), height = 12, width = 15)
  print(plot) 
  dev.off()

  } # close the loop


# Temperature pre October 1st 2023 
# why? we have a hefty gap in the FENC data during all october, this is 
# a clean plot for Genevieve's NACE 2024 presentation
Sonde_Temp_2023 <- Table_by_var %>% 
    dplyr::filter(variable %in% vars[11,]) %>% 
    dplyr::filter(`Date Time` > '2023-06-15 00:00:00' & `Date Time` < '2024-05-01 00:00:00') %>% 
              ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#CC79A7", "#D55E00", "#009E73", "#0072B2")) + 
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site), scales = "free_y") +
              ggtitle(vars[11,]) +
              theme_bw()
 
pdf(paste0(path ="output/raw_plots/Temperature_JuneOct_2023.pdf"), height = 12, width = 15)
print(Sonde_Temp_2023) 
dev.off()
  
```

# Clean CT sites (ASHC and FENC) 
```{r, figs for LISS proposal}

CT_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC', 'ASHC'))
CT_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC', 'ASHC'))
CT_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC'))
CT_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC', 'ASHC'))

# View(CT_Temperature)
# pH 

CT_pH_2023 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - 2023") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")

CT_pH_2023

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots","/CT_pH_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_pH_2024, CT_pH_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_pH_2023)
dev.off()

CT_pH_2024 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none")

CT_pH_2024

CT_pH_callout_2023 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
CT_pH_callout_2023

CT_pH_callout_2024 <- CT_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
#CT_pH_callout_2024

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots","/CT_pH_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_pH_2024, CT_pH_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_pH_2024)
dev.off()
  


# Salinity 

CT_Salinity_2023 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none")
CT_Salinity_2023

CT_Salinity_callout_2023 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
CT_Salinity_callout_2023

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Salinity_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_Salinity_2023, CT_Salinity_callout_2023, ncol = 2, widths = c(2, 1))
print(CT_Salinity_2023)
dev.off()

CT_Salinity_2024 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none")
CT_Salinity_2024

CT_Salinity_callout_2024 <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-11-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
#              theme(legend.position = "none", axis.title.y = element_blank())
#CT_Salinity_callout_2024

  
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Salinity_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_Salinity_2024, CT_Salinity_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_Salinity_2024)
dev.off()

# Temperature 

CT_Temperature_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
CT_Temperature_2023

CT_Temperature_callout_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
CT_Temperature_callout_2023

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Temperature_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2023, CT_Temperature_callout_2023, ncol = 2, widths = c(2, 1))
print(CT_Temperature_2023)
dev.off()

CT_Temperature_2024 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
CT_Temperature_2024

CT_Temperature_callout_2024 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
#CT_Temperature_callout_2024

pdf(paste0(path ="output/raw_plots/LISS_proposal_plots/CT_Temperature_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2024, CT_Temperature_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_Temperature_2024)
dev.off()

# DO (Dissolved Oxygen) 

CT_DO_2023 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")

CT_DO_2023
CT_DO_callout_2023 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
CT_DO_callout_2023
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_DO_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2023, CT_DO_callout_2023, ncol = 2, widths = c(2, 1))
print(CT_DO_2023)
dev.off()

CT_DO_2024 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - 2024") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")

CT_DO_2024
CT_DO_callout_2024 <- CT_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
#CT_DO_callout_2024
pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_DO_2024.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2024, CT_DO_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_DO_2024)
dev.off()


#Grid of June and July 2024 temperature and salinity for HOllings Scholar Juvenille Growth project
Master_table <- Master_table %>% filter(!is.na(Temperature))

Master_table <- Master_table %>% dplyr::mutate(month = month(`Date Time`))

CT_Temperature_jg <- Master_table %>%  
                      dplyr::mutate(`Date Time` = as.factor(substr(`Date Time`,1,13))) %>% # remove minutes and seconds
                      melt(id.vars = c("`Date Time`", "Site"),
                                    measure.vars = c("Actual.Conductivity", "Salinity", "Resistivity", 
                                                     "Total.Dissolved.Solids" ,"RDO.Concentration", "RDO.Saturation",
                                                     "Oxygen.Partial.Pressure", "Chlorophyll.a.Fluorescence", "pH", "pH.mV", 
                                                     "Temperature")) %>% 
                      dplyr::mutate(`Date Time` = ymd_h(`Date Time`), month = month(`Date Time`)) %>%
                      dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC')) %>%                    
                      dplyr::group_by(month, Site, variable) %>% 
                      summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), value)  
                      
CT_Temperature_jg <- CT_Temperature_jg[CT_Temperature_jg$month == "6" , ]
  

#CT_Temperature_jg <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC')) %>% 
##  dplyr:: mutate(month = month(`Date Time`))%>%
#  dplyr:: group_by(Site, month, variable) %>%
#  summarise_each(funs(mean, sd, se=sd(.)/sqrt(n())), mean)
  

CT_Temperature_2024_jg <- CT_Temperature_jg %>%
  #dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>%
  ggplot(aes(x= Site, y = mean, fill = Site )) + geom_bar( stat = "identity", position = "dodge", colour = "black", size = .5) +
   scale_shape_manual(values=c(21, 22, 24, 25)) + 
  scale_fill_manual(values=c("orange1",  "cornflowerblue")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4), colour = "black", size = 2, width = 1) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Mean Temperature June 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")+
  geom_text(
    data = CT_Temperature_jg %>% group_by(Site) %>% slice(which.max(mean)),
    aes(label = round(mean, 1)),
    vjust = -0.5,
    position = position_dodge(0.4)
  ) +
  theme(axis.title = element_text(size = rel(1.7)), axis.text = element_text(size = rel(1.3)), plot.margin = margin(10, 150, 10, 150), legend.text = element_text(size = 13), legend.title = element_text(size = 19))
CT_Temperature_2024_jg

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Temp_Juv_grow.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2024, CT_DO_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_Temperature_2024_jg)
dev.off()

CT_Salinity_2024_jg <- CT_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-06-01 00:00:00' & `Date Time` < '2024-07-01 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("orange1",  "cornflowerblue")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site), ) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - 2024") +
              labs(x = "Date", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.title = element_text(size = rel(1.7)), axis.text = element_text(size = rel(1.3)), strip.text.y = element_text(size = 15))
CT_Salinity_2024_jg

pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Salinity_Juv_grow.pdf"), height = 6, width = 11)
#ggarrange(CT_DO_2024, CT_DO_callout_2024, ncol = 2, widths = c(2, 1))
print(CT_Salinity_2024_jg)
dev.off()


```

```{r}
#Adding linear regression lines and equations to temperature data
#Going to use this to compare temperature of 2023 and 2024 when more data overlaps
CT_Temperature_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
CT_Temperature_2023

#pdf(paste0(path = "output/raw_plots/LISS_proposal_plots/CT_Temperature_2023.pdf"), height = 6, width = 11)
#ggarrange(CT_Temperature_2023, CT_Temperature_callout_2023, ncol = 2, widths = c(2, 1))
#print(CT_Temperature_2023)
#dev.off()

```

```{r}
CT_Temperature_2023 <- CT_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
CT_Temperature_2023
```



```{r}
#Separating temperature data by year at ASHC
CT_Temperature_test <- CT_Temperature %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_Temperature_test$`Date Time` <- sub('.....', '', CT_Temperature$`Date Time`) 
CT_Temperature_ASHC <- CT_Temperature_test %>% filter(!Site=="FENC")
CT_Temperature_ASHC$`Date Time` <- as.Date(CT_Temperature_ASHC$`Date Time`, "%m-%d")
CT_Temperature_ASHC$Year <- as.factor(CT_Temperature_ASHC$Year)

CT_Temperature_ASHC_yearly <- CT_Temperature_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - ASHC") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic()

CT_Temperature_ASHC_yearly
```
```{r}
#Separating salinity data by year at ASHC
CT_Salinity_test <- CT_Salinity %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_Salinity_test$`Date Time` <- sub('.....', '', CT_Salinity_test$`Date Time`) 
CT_Salinity_ASHC <- CT_Salinity_test %>% filter(!Site=="FENC")
CT_Salinity_ASHC$`Date Time` <- as.Date(CT_Salinity_ASHC$`Date Time`, "%m-%d")
CT_Salinity_ASHC$Year <- as.factor(CT_Salinity_ASHC$Year)

CT_Salinity_ASHC_yearly <- CT_Salinity_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - ASHC") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()

CT_Salinity_ASHC_yearly
```
```{r}
#Separating pH data by year at ASHC
CT_pH_test <- CT_pH %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_pH_test$`Date Time` <- sub('.....', '', CT_pH_test$`Date Time`) 
CT_pH_ASHC <- CT_pH_test %>% filter(!Site=="FENC")
CT_pH_ASHC$`Date Time` <- as.Date(CT_pH_ASHC$`Date Time`, "%m-%d")
CT_pH_ASHC$Year <- as.factor(CT_pH_ASHC$Year)

CT_pH_ASHC_yearly <- CT_pH_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - ASHC") +
              labs(x = "Time", y = "pH") +
              theme_classic()

CT_pH_ASHC_yearly
```
```{r}
#Separating DO data by year at ASHC
CT_pH_test <- CT_pH %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_pH_test$`Date Time` <- sub('.....', '', CT_pH_test$`Date Time`) 
CT_pH_ASHC <- CT_pH_test %>% filter(!Site=="FENC")
CT_pH_ASHC$`Date Time` <- as.Date(CT_pH_ASHC$`Date Time`, "%m-%d")
CT_pH_ASHC$Year <- as.factor(CT_pH_ASHC$Year)

CT_pH_ASHC_yearly <- CT_pH_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - ASHC") +
              labs(x = "Time", y = "pH") +
              theme_classic()

CT_pH_ASHC_yearly
```

```{r}
#Separating DO data by year at ASHC
CT_DO_test <- CT_DO %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_DO_test$`Date Time` <- sub('.....', '', CT_DO_test$`Date Time`) 
CT_DO_ASHC <- CT_DO_test %>% filter(!Site=="FENC")
CT_DO_ASHC$`Date Time` <- as.Date(CT_DO_ASHC$`Date Time`, "%m-%d")
CT_DO_ASHC$Year <- as.factor(CT_DO_ASHC$Year)

CT_DO_ASHC_yearly <- CT_DO_ASHC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - ASHC") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()

CT_DO_ASHC_yearly
```

# Clean ASHC for the LISS stakeholder reports (CT)
```{r, figs for LISS stakeholder reports}

ASHC_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('ASHC'))
ASHC_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('ASHC'))
ASHC_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('ASHC'))
ASHC_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO.Concentration' & Site %in% c('ASHC'))
ASHC_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll.a.Fluorescence' & Site %in% c('ASHC'))

# pH 

ASHC_pH_2023 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>%  # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2023 ") +
              labs(x = "Time ", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_pH_callout_2023 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_pH_2023
ASHC_pH_callout_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_pH_2023.pdf"), height = 7, width = 14)
print(ASHC_pH_2023)
#ggarrange(ASHC_pH_all,ASHC_pH_callout, ncol = 2, widths = c(2, 1))
dev.off()
  
ASHC_pH_2024 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>%  # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_pH_callout_2024 <- ASHC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_pH_2024
#ASHC_pH_callout_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_pH_2024.pdf"), height = 7, width = 14)
print(ASHC_pH_2024)
#ggarrange(ASHC_pH_all,ASHC_pH_callout, ncol = 2, widths = c(2, 1))
dev.off()


# Salinity 

ASHC_Salinity_2023 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_Salinity_2023

ASHC_Salinity_2023 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

ASHC_Salinity_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Salinity_2023.pdf"), height = 7, width = 14)
print(ASHC_Salinity_2023)
#ggarrange(ASHC_Salinity_all,ASHC_Salinity_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_Salinity_2024 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_Salinity_2024

ASHC_Salinity_callout_2024 <- ASHC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

#ASHC_Salinity_callout_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Salinity_2024.pdf"), height = 7, width = 14)
print(ASHC_Salinity_2024)
#ggarrange(ASHC_Salinity_all,ASHC_Salinity_callout, ncol = 2, widths = c(2, 1))
dev.off()

# Temperature 

ASHC_Temperature_2023 <-ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
ASHC_Temperature_2023

ASHC_Temperature_callout_2023 <- ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
ASHC_Temperature_callout_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Temperature_2023.pdf"), height = 7, width = 14)
print(ASHC_Temperature_2023)
#ggarrange(ASHC_Temperature_all, ASHC_Temperature_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_Temperature_2024 <-ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
ASHC_Temperature_2024

ASHC_Temperature_callout_2024 <- ASHC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - Diurnal cycle 2024") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())
#ASHC_Temperature_callout_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_Temperature_2024.pdf"), height = 7, width = 14)
print(ASHC_Temperature_2024)
#ggarrange(ASHC_Temperature_all, ASHC_Temperature_callout, ncol = 2, widths = c(2, 1))
dev.off()

# DO 

ASHC_DO_2023 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_DO_callout_2023 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-08-03 00:00:00' & `Date Time` < '2023-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle 2023") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_DO_2023.pdf"), height = 7, width = 14)
print(ASHC_DO_2023)
#ggarrange(ASHC_DO_all, ASHC_DO_callout, ncol = 2, widths = c(2, 1))
dev.off()

ASHC_DO_2024 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_DO_callout_2024 <- ASHC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-08-03 00:00:00' & `Date Time` < '2024-08-06 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration - Diurnal cycle") +
              #ggtitle(NA) +
              labs(x = "Time") +
              theme_classic() +
              theme(legend.position = "none", axis.title.y = element_blank())

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_DO_2024.pdf"), height = 7, width = 14)
print(ASHC_DO_2024)
#ggarrange(ASHC_DO_all, ASHC_DO_callout, ncol = 2, widths = c(2, 1))
dev.off()

#Chlorophyll-a

ASHC_CHLA_2023 <- ASHC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2023 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_CHLA_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_CHLA_2023.pdf"), height = 7, width = 14)
print(ASHC_CHLA_2023)

ASHC_CHLA_2024 <- ASHC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'ASHC' ~ 'Ash Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2024 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

ASHC_CHLA_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_CHLA_2024.pdf"), height = 7, width = 14)
print(ASHC_CHLA_2024)
```
```{r}

## DAILY AVERAGES OF DO - ASHC###

ASHC_DO$`Date Time` <- as.character(ASHC_DO$`Date Time`)
date_time <- strsplit(ASHC_DO$`Date Time`, " ")  # Split at the space
print(ASHC_DO)

# Create separate columns for date and time
ASHC_DO$date <- sapply(date_time, "[[", 1)  # Extract date
#ASHC_DO$time <- sapply(date_time, "[[", 2)
print(ASHC_DO)


ASHC_DO_avg <- ASHC_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
ASHC_DO_avg

 

class(ASHC_DO_avg$Date)
ASHC_DO_avg$date <- as.Date(ASHC_DO_avg$date)

ASHC_DAILY_DO_2023 <- ASHC_DO_avg %>% 
   dplyr::filter(date() > '2023-06-01 00:00:00' & date < '2023-11-30 00:00:00' ) %>%
    ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  scale_y_continuous(limits= c(2,10), breaks = seq(2,10, by= 1))



ASHC_DAILY_DO_2023

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_daily_DO_2023.pdf"), height = 7, width = 14)
print(ASHC_DAILY_DO_2023)


ASHC_DAILY_DO_2024 <- ASHC_DO_avg %>% 
   dplyr::filter(date() > '2024-03-01 00:00:00' & date < '2024-11-30 00:00:00' ) %>%
    ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d") +
  scale_y_continuous(limits= c(2,10), breaks = seq(2,10, by= 1))


ASHC_DAILY_DO_2024

pdf(paste0(path = "output/raw_plots/Report_plots/ASHC_daily_DO_2024.pdf"), height = 7, width = 14)
print(ASHC_DAILY_DO_2024)

# Monthly mean temperatures ASHC
ASHC_Temperature$`Date Time` <- as.character(ASHC_Temperature$`Date Time`)
date_time <- strsplit(ASHC_Temperature$`Date Time`, " ")  # Split at the space
print(ASHC_Temperature)

# Create separate columns for date and time
ASHC_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
#ASHC_Temperature$time <- sapply(date_time, "[[", 2)
print(ASHC_Temperature)

ASHC_Temperature$Month <- month(ASHC_Temperature$date, label = TRUE)
head(ASHC_Temperature)

ASHC_Temperature$Year <- year(ASHC_Temperature$date)
head(ASHC_Temperature)

ASHC_Monthly_Temperature <- ASHC_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
ASHC_Monthly_Temperature

```

#Graphed sonde data for FENC seperated by year
```{r}
#Separating temperature data by year at FENC
CT_temp_test <- CT_Temperature %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_temp_test$`Date Time` <- sub('.....', '', CT_temp_test$`Date Time`) 
CT_temp_FENC <- CT_temp_test %>% filter(!Site=="ASHC")
CT_temp_FENC$`Date Time` <- as.Date(CT_temp_FENC$`Date Time`, "%m-%d")
CT_temp_FENC$Year <- as.factor(CT_temp_FENC$Year)

CT_temp_FENC_yearly <- CT_temp_FENC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              geom_hline(yintercept = 30, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - FENC") +
              labs(x = "Time", y = "Temperature (C)") +
              theme_classic()

CT_temp_FENC_yearly
```
```{r}
#Separating salinity data by year at FENC
CT_salinity_test <- CT_Salinity %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_salinity_test$`Date Time` <- sub('.....', '', CT_salinity_test$`Date Time`) 
CT_salinity_FENC <- CT_salinity_test %>% filter(!Site=="ASHC")
CT_salinity_FENC$`Date Time` <- as.Date(CT_salinity_FENC$`Date Time`, "%m-%d")
CT_salinity_FENC$Year <- as.factor(CT_salinity_FENC$Year)

CT_salinity_FENC_yearly <- CT_salinity_FENC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - FENC") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()

CT_salinity_FENC_yearly
```
```{r}
#Separating pH data by year at FENC

#CT_pH_test <- CT_pH %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
#CT_pH_test$`Date Time` <- sub('.....', '', CT_pH_test$`Date Time`) 
CT_ph_FENC <- CT_pH_test %>% filter(!Site=="ASHC")
CT_ph_FENC$`Date Time` <- as.Date(CT_ph_FENC$`Date Time`, "%m-%d")
CT_ph_FENC$Year <- as.factor(CT_ph_FENC$Year)

CT_pH_FENC_yearly <- CT_ph_FENC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 7.5, color = "red", size = 1)+
              geom_hline(yintercept = 7, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - FENC") +
              labs(x = "Time", y = "pH") +
              theme_classic()

CT_pH_FENC_yearly
```
```{r}
#Separating DO data by year at FENC

CT_DO_test <- CT_DO %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
CT_DO_test$`Date Time` <- sub('.....', '', CT_DO_test$`Date Time`) 
CT_DO_FENC <- CT_DO_test %>% filter(!Site=="ASHC")
CT_DO_FENC$`Date Time` <- as.Date(CT_DO_FENC$`Date Time`, "%m-%d")
CT_DO_FENC$Year <- as.factor(CT_DO_FENC$Year)

CT_DO_FENC_yearly <- CT_DO_FENC %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 2, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - FENC") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()

CT_DO_FENC_yearly
```

# Clean FENC for the LISS stakeholder reports (CT)
```{r, figs for LISS stakeholder reports}

FENC_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC'))
FENC_Salinity   <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC'))
FENC_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC'))
FENC_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC'))
FENC_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('FENC'))

# pH 

FENC_pH_2023 <- FENC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Ash Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2023") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


FENC_pH_2023


pdf(paste0(path = "output/raw_plots/Report_plots/FENC_pH_2023.pdf"), height = 7, width = 14)
print(FENC_pH_2023)
dev.off()
  
FENC_pH_2024 <- FENC_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Ash Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2024 ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


FENC_pH_2024


pdf(paste0(path= "output/raw_plots/Report_plots/FENC_pH_.pdf"), height = 7, width = 14)
print(FENC_pH_2024)
dev.off()

# Salinity 

FENC_Salinity_2023 <- FENC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

FENC_Salinity_2023

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_Salinity_2023.pdf"), height = 7, width = 14)
print(FENC_Salinity_2023)
dev.off()

FENC_Salinity_2024 <- FENC_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

FENC_Salinity_2024

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_Salinity_2024.pdf"), height = 7, width = 14)
print(FENC_Salinity_2024)
dev.off()

# Temperature 

FENC_Temperature_2023 <-FENC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
FENC_Temperature_2023


pdf(paste0(path="output/raw_plots/Report_plots/FENC_Temperature_2023.pdf"), height = 7, width = 14)
print(FENC_Temperature_2023)
dev.off()

FENC_Temperature_2024 <-FENC_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
FENC_Temperature_2024


pdf(paste0(path="output/raw_plots/Report_plots/FENC_Temperature_2024.pdf"), height = 7, width = 14)
print(FENC_Temperature_2024)
dev.off()

# DO 

FENC_DO_2023 <- FENC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_DO_2023.pdf"), height = 7, width = 14)
print(FENC_DO_2023)
dev.off()

FENC_DO_2024 <- FENC_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path = "output/raw_plots/Report_plots/FENC_DO_2024.pdf"), height = 7, width = 14)
print(FENC_DO_2024)
dev.off()

#Chlorophyll-a

FENC_CHLA_2023 <- FENC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2023") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

FENC_CHLA_2023

pdf(paste0(path="output/raw_plots/Report_plots/FENC_CHLA_2023.pdf"), height = 7, width = 14)
print(FENC_CHLA_2023)

FENC_CHLA_2024 <- FENC_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-03-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'FENC' ~ 'Fence Creek', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2024") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

FENC_CHLA_2024

pdf(paste0(path="output/raw_plots/Report_plots/FENC_CHLA_2024.pdf"), height = 7, width = 14)
print(FENC_CHLA_2024)

```

```{r}

## DAILY AVERAGES OF DO - FENC ###

FENC_DO$`Date Time` <- as.character(FENC_DO$`Date Time`)
date_time <- strsplit(FENC_DO$`Date Time`, " ")  # Split at the space
print(FENC_DO)

# Create separate columns for date and time
FENC_DO$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_DO)


FENC_DO_avg <- FENC_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
FENC_DO_avg


class(FENC_DO_avg$Date)
FENC_DO_avg$date <- as.Date(FENC_DO_avg$date)

FENC_DO_avg

FENC_DAILY_DO_2023 <- FENC_DO_avg %>% dplyr::filter(`date` > '2023-06-01 00:00:00' & `date` < '2023-10-15 00:00:00' ) %>% 
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


FENC_DAILY_DO_2023

pdf(paste0(path="output/raw_plots/Report_plots/FENC_daily_DO_2023.pdf"), height = 7, width = 14)
print(FENC_DAILY_DO_2023)

FENC_DAILY_DO_2024 <- FENC_DO_avg %>% dplyr::filter(`date` > '2024-03-01 00:00:00' & `date` < '2024-11-30 00:00:00' ) %>% 
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


FENC_DAILY_DO_2024

pdf(paste0(path="output/raw_plots/Report_plots/FENC_daily_DO_2024.pdf"), height = 7, width = 14)
print(FENC_DAILY_DO_2024)

# Monthly mean temperatures ASHC
FENC_Temperature$`Date Time` <- as.character(FENC_Temperature$`Date Time`)
date_time <- strsplit(FENC_Temperature$`Date Time`, " ")  # Split at the space
print(FENC_Temperature)

# Create separate columns for date and time
FENC_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_Temperature)

FENC_Temperature$Month <- month(FENC_Temperature$date, label = TRUE)
head(FENC_Temperature)

FENC_Temperature$Year <- year(FENC_Temperature$date)
head(FENC_Temperature)

FENC_Monthly_Temperature <-FENC_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
FENC_Monthly_Temperature

#Salinity average
FENC_Salinity$`Date Time` <- as.character(FENC_Salinity$`Date Time`)
date_time <- strsplit(FENC_Salinity$`Date Time`, " ")  # Split at the space
print(FENC_Salinity)

# Create separate columns for date and time
FENC_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
FENC_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(FENC_Salinity)

FENC_Salinity$Month <- month(FENC_Salinity$date, label = TRUE)
head(FENC_Salinity)

FENC_Salinity$Year <- year(FENC_Salinity$date)
head(FENC_Salinity)

FENC_Monthly_Salinity <- FENC_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
FENC_Monthly_Salinity

```


# Clean GOLD for the LISS stakeholder reports (NEW YORK)
#I want to create code to remove outliers for these graphs. Outliers are obvious temperature drops when the sonde is removed from the water. 
```{r, figs for LISS stakeholder reports}

GOLD_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('GOLD')) 
GOLD_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('GOLD'))
GOLD_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('GOLD'))
GOLD_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('GOLD'))
GOLD_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('GOLD'))




# pH 

GOLD_pH_2023 <- GOLD_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2023") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


GOLD_pH_2023


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_pH_2023.pdf"), height = 7, width = 14)
print(GOLD_pH_2023)
dev.off()
  
GOLD_pH_2024 <- GOLD_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH 2024") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


GOLD_pH_2024


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_pH_2024.pdf"), height = 7, width = 14)
print(GOLD_pH_2024)
dev.off()

# Salinity 

GOLD_Salinity_2023 <- GOLD_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2023") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

GOLD_Salinity_2023

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Salinity_2023.pdf"), height = 7, width = 14)
print(GOLD_Salinity_2023)
dev.off()

GOLD_Salinity_2024 <- GOLD_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity 2024") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(breaks = seq(0,30, by = 2))

GOLD_Salinity_2024

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Salinity_2024.pdf"), height = 7, width = 14)
print(GOLD_Salinity_2024)
dev.off()

# Temperature 

GOLD_Temperature_2023 <-GOLD_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
GOLD_Temperature_2023


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Temperature_2023.pdf"), height = 7, width = 14)
print(GOLD_Temperature_2023)
dev.off()

GOLD_Temperature_2024 <-GOLD_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature 2024") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
GOLD_Temperature_2024


pdf(paste0(path="output/raw_plots/Report_plots/GOLD_Temperature_2024.pdf"), height = 7, width = 14)
print(GOLD_Temperature_2024)
dev.off()

# DO 

GOLD_DO_2023 <- GOLD_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              #facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_DO_2023.pdf"), height = 7, width = 14)
print(GOLD_DO_2023)
dev.off()

GOLD_DO_2024 <- GOLD_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
GOLD_DO_2023
pdf(paste0(path="output/raw_plots/Report_plots/GOLD_DO_2024.pdf"), height = 7, width = 14)
print(GOLD_DO_2024)
dev.off()
#Chlorophyll-a

GOLD_CHLA_2023 <- GOLD_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2023 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

GOLD_CHLA_2023

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_CHLA_2023.pdf"), height = 7, width = 14)
print(GOLD_CHLA_2023)

GOLD_CHLA_2024 <- GOLD_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             dplyr::mutate(Site = case_when(Site == 'GOLD' ~ 'Gold Star', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences 2024 ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

GOLD_CHLA_2024

pdf(paste0(path="output/raw_plots/Report_plots/GOLD_CHLA_2024.pdf"), height = 7, width = 14)
print(GOLD_CHLA_2024)
```
#Graphed sonde data for GOLD seperated by year
```{r}
#Separating temperature data by year at GOLD
NY_temp_test <- NY_Temperature %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
NY_temp_test$`Date Time` <- sub('.....', '', NY_temp_test$`Date Time`) 
NY_temp_GOLD <- NY_temp_test %>% filter(!Site=="ASHC")
NY_temp_GOLD$`Date Time` <- as.Date(NY_temp_GOLD$`Date Time`, "%m-%d")
NY_temp_GOLD$Year <- as.faNYor(NY_temp_GOLD$Year)

NY_temp_GOLD_yearly <- NY_temp_GOLD %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 20, color = "red", size = 1)+
              geom_hline(yintercept = 30, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - GOLD") +
              labs(x = "Time", y = "Temperature (C)") +
              theme_classic()

NY_temp_GOLD_yearly
```
```{r}
#Separating salinity data by year at GOLD
NY_salinity_test <- NY_Salinity %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
NY_salinity_test$`Date Time` <- sub('.....', '', NY_salinity_test$`Date Time`) 
NY_salinity_GOLD <- NY_salinity_test %>% filter(!Site=="ASHC")
NY_salinity_GOLD$`Date Time` <- as.Date(NY_salinity_GOLD$`Date Time`, "%m-%d")
NY_salinity_GOLD$Year <- as.faNYor(NY_salinity_GOLD$Year)

NY_salinity_GOLD_yearly <- NY_salinity_GOLD %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 15, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity - GOLD") +
              labs(x = "Time", y = "Salinity (ppt)") +
              theme_classic()

NY_salinity_GOLD_yearly
```
```{r}
#Separating pH data by year at GOLD

#NY_pH_test <- NY_pH %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
#NY_pH_test$`Date Time` <- sub('.....', '', NY_pH_test$`Date Time`) 
NY_ph_GOLD <- NY_pH_test %>% filter(!Site=="ASHC")
NY_ph_GOLD$`Date Time` <- as.Date(NY_ph_GOLD$`Date Time`, "%m-%d")
NY_ph_GOLD$Year <- as.faNYor(NY_ph_GOLD$Year)

NY_pH_GOLD_yearly <- NY_ph_GOLD %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 7.5, color = "red", size = 1)+
              geom_hline(yintercept = 6.75, color = "blue", size = .5)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH - GOLD") +
              labs(x = "Time", y = "pH") +
              theme_classic()

NY_pH_GOLD_yearly
```
```{r}
#Separating DO data by year at GOLD

NY_DO_test <- NY_DO %>% dplyr::mutate(`Date Time`= as.Date(`Date Time`), Year = year(`Date Time`))
NY_DO_test$`Date Time` <- sub('.....', '', NY_DO_test$`Date Time`) 
NY_DO_GOLD <- NY_DO_test %>% filter(!Site=="ASHC")
NY_DO_GOLD$`Date Time` <- as.Date(NY_DO_GOLD$`Date Time`, "%m-%d")
NY_DO_GOLD$Year <- as.faNYor(NY_DO_GOLD$Year)

NY_DO_GOLD_yearly <- NY_DO_GOLD %>% na.omit() %>%
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site,
                       fill = Year)) + # call the new mean
              geom_line(aes(group = faNYor(Site), # lines for site
                                linetype = Site), 
                            size = 0.1, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Year,
                             fill=Year)) + 
              geom_hline(yintercept = 2, color = "red", size = 1)+
              scale_shape_manual(values=c(21, 22, 24, 25)) +
              scale_colour_manual(values=c("2023"="#D55E00",  "2024"="#0072B2")) +
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Year)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - GOLD") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic()

NY_DO_GOLD_yearly
```

```{r}
pH_CT.GOLD          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('FENC', 'ASHC','GOLD'))
Salinity_CT.GOLD    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('FENC', 'ASHC','GOLD'))
Temperature_CT.GOLD <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('FENC', 'ASHC','GOLD'))
DO_CT.GOLD          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('FENC', 'ASHC','GOLD'))
```
```{r}
Temperature_2023 <- Temperature_CT.GOLD %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-07-01 00:00:00' & `Date Time` < '2023-10-15 00:00:00' ) %>% # change date range needed here
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2", "gray")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature - 2023") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none")
Temperature_2023

```
```{r}
DO_2024 <- DO_CT.GOLD %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2024-04-20 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>% # change date range needed here
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2", "gray")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              stat_cor(label.y = 32)+
              geom_smooth(method = "lm")+
              stat_regline_equation(label.y = 35)+
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO - 2024") +
              labs(x = "Time", y = "DO (mg/L)") +
              theme_classic() +
              theme(legend.position = "none")
DO_2024
```



```{r}

## DAILY AVERAGES OF DO - GOLD###

GOLD_DO$`Date Time` <- as.character(GOLD_DO$`Date Time`)
date_time <- strsplit(GOLD_DO$`Date Time`, " ")  # Split at the space
print(GOLD_DO)

# Create separate columns for date and time
GOLD_DO$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_DO)

GOLD_DO$year<- year(GOLD_DO$date_time)

GOLD_DO_avg <- GOLD_DO %>% na.omit() %>%
  dplyr::group_by(date , year, Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
GOLD_DO_avg


class(GOLD_DO_avg$Date)
GOLD_DO_avg$date <- as.Date(GOLD_DO_avg$date)

GOLD_DAILY_DO_2023 <- GOLD_DO_avg %>% 
   dplyr::filter(Date Time > '2023-04-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>%
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2023") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")


GOLD_DAILY_DO_2023

pdf(paste0(path="/raw_plots/Report_plots/GOLD_daily_DO_2023.pdf"), height = 7, width = 14)
print(GOLD_DAILY_DO_2023)

GOLD_DAILY_DO_2024 <- GOLD_DO_avg %>% 
   dplyr::filter(`Date Time` > '2024-04-01 00:00:00' & `Date Time` < '2024-11-30 00:00:00' ) %>%
  ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration 2024") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")


GOLD_DAILY_DO_2024

pdf(paste0(path="/raw_plots/Report_plots/GOLD_daily_DO_2024.pdf"), height = 7, width = 14)
print(GOLD_DAILY_DO_2024)

# Monthly mean temperatures ASHC
GOLD_Temperature$`Date Time` <- as.character(GOLD_Temperature$`Date Time`)
date_time <- strsplit(GOLD_Temperature$`Date Time`, " ")  # Split at the space
print(GOLD_Temperature)

# Create separate columns for date and time
GOLD_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_Temperature)

GOLD_Temperature$Month <- month(GOLD_Temperature$date, label = TRUE)
GOLD_Temperature$Year <- year(GOLD_Temperature$date, label = TRUE)
head(GOLD_Temperature)


GOLD_Monthly_Temperature <- GOLD_Temperature %>% na.omit() %>%
  dplyr::group_by(Month ,Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
GOLD_Monthly_Temperature

#Salinity average
GOLD_Salinity$`Date Time` <- as.character(GOLD_Salinity$`Date Time`)
date_time <- strsplit(GOLD_Salinity$`Date Time`, " ")  # Split at the space
print(GOLD_Salinity)

# Create separate columns for date and time
GOLD_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
GOLD_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(GOLD_Salinity)

GOLD_Salinity$Month <- month(GOLD_Salinity$date, label = TRUE)
GOLD_Salinity$Year <- year(GOLD_Salinity$date)
head(GOLD_Salinity)


GOLD_Monthly_Salinity <- GOLD_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Year, Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
GOLD_Monthly_Salinity

```


#NO LONGER STUDYING THIS SITE - LAUR

# Clean LAUR for the LISS stakeholder reports

```{r, figs for LISS stakeholder reports}

LAUR_pH          <- Master_table_LONG_means %>% dplyr::filter(variable == 'pH' & Site %in% c('LAUR'))
LAUR_Salinity    <- Master_table_LONG_means %>% dplyr::filter(variable == 'Salinity' & Site %in% c('LAUR'))
LAUR_Temperature <- Master_table_LONG_means %>% dplyr::filter(variable == 'Temperature' & Site %in% c('LAUR'))
LAUR_DO          <- Master_table_LONG_means %>% dplyr::filter(variable == 'RDO Concentration' & Site %in% c('LAUR'))
LAUR_CHLA        <- Master_table_LONG_means %>% dplyr::filter(variable == 'Chlorophyll-a Fluorescence' & Site %in% c('LAUR'))

# pH 
LAUR_pH

LAUR_pH_all <- LAUR_pH %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-20 11:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("pH ") +
              labs(x = "Time", y = "pH") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))


LAUR_pH_all


pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_pH.pdf"), height = 7, width = 14)
print(LAUR_pH_all)
dev.off()
  


# Salinity 
## There are a few outliers in the dataset form removing the sonde to download data. Here is a temporary filter for graphing purposes:
LAUR_Salinity <- LAUR_Salinity[LAUR_Salinity$mean < 35 & LAUR_Salinity$mean > 24, ]

LAUR_Salinity_all <- LAUR_Salinity %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Salinity") +
              labs(x = "Time", y = "Salinity") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))+
              scale_y_continuous(limits = c(0,30),breaks = seq(0,30, by = 2))

LAUR_Salinity_all

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_Salinity.pdf"), height = 7, width = 14)
print(LAUR_Salinity_all)
dev.off()


# Temperature 

LAUR_Temperature_all <-LAUR_Temperature %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Temperature") +
              labs(x = "Time", y = "Temperature (Celcius)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))
LAUR_Temperature_all


pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_Temperature.pdf"), height = 7, width = 14)
print(LAUR_Temperature_all)
dev.off()


# DO 

LAUR_DO_all <- LAUR_DO %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_DO.pdf"), height = 7, width = 14)
print(LAUR_DO_all)
dev.off()

#Chlorophyll-a

LAUR_CHLA_all <- LAUR_CHLA %>% na.omit() %>%
             dplyr::filter(`Date Time` > '2023-06-01 00:00:00' & `Date Time` < '2023-11-30 00:00:00' ) %>% 
             dplyr::mutate(Site = case_when(Site == 'LAUR' ~ 'Laurel Hollow', .default = 'Fence Creek')) %>% 
             ggplot(aes(x=`Date Time`, 
                       y=mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              geom_errorbar(aes(ymin=(mean)-(se), 
                                ymax=(mean)+(se)), 
                            width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("Chlorophyll-a flourescences ") +
              labs(x = "Time", y = "Chlorophyll-a (RFU)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 15))

LAUR_CHLA_all

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_CHLA.pdf"), height = 7, width = 14)
print(LAUR_CHLA_all)

```

```{r}

## DAILY AVERAGES OF DO - LAUR ###

LAUR_DO$`Date Time` <- as.character(LAUR_DO$`Date Time`)
date_time <- strsplit(LAUR_DO$`Date Time`, " ")  # Split at the space
print(LAUR_DO)

# Create separate columns for date and time
LAUR_DO$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_DO$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_DO)


LAUR_DO_avg <- LAUR_DO %>% na.omit() %>%
  dplyr::group_by(date , Site)%>%
  dplyr::summarize(Daily_mean = mean(mean))
LAUR_DO_avg


class(LAUR_DO_avg$Date)
LAUR_DO_avg$date <- as.Date(LAUR_DO_avg$date)

LAUR_DAILY_DO <- LAUR_DO_avg %>% ggplot(aes(x= date, 
                       y=Daily_mean, # the mean values
                       group=Site)) + # call the new mean
              geom_line(aes(group = factor(Site), # lines for site
                                linetype = Site), 
                            size = 0.2, 
                            position=position_dodge(.4)) + 
              # scale_linetype_manual(values=c("solid", "dashed")) +
              geom_point(aes(shape=Site, 
                             fill=Site)) + 
              scale_shape_manual(values=c(21, 22, 24, 25)) + 
              scale_fill_manual(values=c("#D55E00",  "#0072B2")) + # "#CC79A7","#009E73"
              #geom_errorbar(aes(ymin=(mean)-(se), 
                                #ymax=(mean)+(se)), 
                           # width=0,position=position_dodge(.4)) +
              facet_grid(rows = vars(Site)) + # , scales = "free_y" - if you wnat different y axis labels
              ggtitle("DO Concentration") +
              labs(x = "Time", y = "Daily Mean DO Concentration (mg/L)") +
              theme_classic() +
              theme(legend.position = "none", axis.text= element_text(size= 10),axis.text.x = element_text(angle = 45, hjust = 1))+scale_x_date(date_breaks = "1 week", date_labels = "%b %d")  +  scale_y_continuous(limits = c(0,10), breaks = seq(0,10, by = 1))


LAUR_DAILY_DO

pdf(paste0(path_out,"/raw_plots/Report_plots/LAUR_daily_DO.pdf"), height = 7, width = 14)
print(LAUR_DAILY_DO)

# Monthly mean temperatures ASHC
LAUR_Temperature$`Date Time` <- as.character(LAUR_Temperature$`Date Time`)
date_time <- strsplit(LAUR_Temperature$`Date Time`, " ")  # Split at the space
print(LAUR_Temperature)

# Create separate columns for date and time
LAUR_Temperature$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_Temperature$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_Temperature)

LAUR_Temperature$Month <- month(LAUR_Temperature$date, label = TRUE)
head(LAUR_Temperature)

LAUR_Monthly_Temperature <- LAUR_Temperature %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
LAUR_Monthly_Temperature

#Salinity average
LAUR_Salinity$`Date Time` <- as.character(LAUR_Salinity$`Date Time`)
date_time <- strsplit(LAUR_Salinity$`Date Time`, " ")  # Split at the space
print(LAUR_Salinity)

# Create separate columns for date and time
LAUR_Salinity$date <- sapply(date_time, "[[", 1)  # Extract date
LAUR_Salinity$time <- sapply(date_time, function(x) {
  if(length(x) >= 2) {
    x[[2]]  # Extract the second element if it exists
  } else {
    NA  # Assign NA if the vector is too short
  }
})
print(LAUR_Salinity)

LAUR_Salinity$Month <- month(LAUR_Salinity$date, label = TRUE)
head(LAUR_Salinity)

LAUR_Monthly_Salinity <- LAUR_Salinity %>% na.omit() %>%
  dplyr::group_by(Month , Site)%>%
  dplyr::summarize(Monthly_mean = mean(mean))
LAUR_Monthly_Salinity

```

